<!doctype html>
<!--[if lt IE 7 ]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<title>{{title}}</title>

<meta name="description" content="{{description}}">
<meta name="author" content="{{author}}">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<link rel="shortcut icon" href="img/favicon.ico">
<link rel="apple-touch-icon" href="img/apple-touch-icon.png">
<link rel="stylesheet" href="css/style.css?v=2">
<link rel="stylesheet" media="handheld" href="css/handheld.css?v=2">
<script src="js/modernizr.js" type="text/javascript"></script>

<link rel="stylesheet"
    href="http://ajax.googleapis.com/ajax/libs/dojo/1.6/dijit/themes/claro/claro.css" />
<script src="js/underscore.js" type="text/javascript"></script>
<script
    src="http://ajax.googleapis.com/ajax/libs/dojo/1.6.0/dojo/dojo.xd.js"
    type="text/javascript"></script>
<script src="js/visualize.js" type="text/javascript"></script>

<script type="text/javascript">
    var queryParams = function() {
        var url = window.location.toString();
        url.match(/\?(.+)$/);
        var params = RegExp.$1;
        var params = params.split("&");
        var queryStringList = {};
        for ( var i = 0; i < params.length; i++) {
            var tmp = params[i].split("=");
            queryStringList[tmp[0]] = unescape(tmp[1]);
        }
        return queryStringList;
    };
    var now = new Date().getTime();
    var payload = {
      "start":now - 15 * 60 * 1000,
      "end" : now,
      "count" : 60,
      "collections" : {
        "jmx" : {
           "HeapMemoryUsage used" : {
           "timestamp" : "response.timestamp",
           "field" : "response.value.HeapMemoryUsage.used",
           "qualifiers" : {},
           "operation" : "AVG"
          },
           "HeapMemoryUsage committed" : {
           "timestamp" : "response.timestamp",
           "field" : "response.value.HeapMemoryUsage.committed",
           "qualifiers" : {},
           "operation" : "AVG"
          }
        }, 
      },
    };
    var chart = new com.wm.data.Viewer("chart", "/query", payload, queryParams());
    dojo.addOnLoad(function() {
        chart.render();
    });
</script>
</head>

<body>
  <div id="container">
    <header>
    </header>
    <div id="main" role="main">{{{ body }}}</div>
    <div id="chart" style="width: 100%; height: 250px;"></div>
    <footer> </footer>
  </div>


  <!-- JavaScript at the bottom for fast page loading -->

  <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js" type="text/javascript"></script>
  <script type="text/javascript">window.jQuery || document.write("<script src='js/libs/jquery-1.5.1.min.js'>\x3C/script>")</script>


  <!-- scripts concatenated and minified via ant build script-->
  <script src="js/plugins.js" type="text/javascript"></script>
  <script src="js/script.js" type="text/javascript"></script>
  <!-- end scripts-->


  <!--[if lt IE 7 ]>
    <script src="js/libs/dd_belatedpng.js"></script>
    <script>DD_belatedPNG.fix("img, .png_bg"); // Fix any <img> or .png_bg bg-images. Also, please read goo.gl/mZiyb </script>
  <![endif]-->


  <!-- mathiasbynens.be/notes/async-analytics-snippet Change UA-XXXXX-X to be your site's ID -->
  <script type="text/javascript">
    var _gaq=[["_setAccount","UA-24488661-1"],["_trackPageview"]];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
    g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
    s.parentNode.insertBefore(g,s)}(document,"script"));
  </script>

</body>
</html>
